<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arduino va 8x8 LED Matrix Simulyatsiyasi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #e6f3ff;
            min-height: 100vh;
            padding: 20px;
            overflow-x: auto;
        }

        /* HEADER */
        .header {
            display: flex;
            align-items: center;
            background: #000075;
            color: white;
            padding: 10px 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
            width: 100%;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
            font-weight: bold;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            border: 2px solid white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #000075;
        }

        /* MAIN LAYOUT */
        .main-container {
            display: flex;
            margin-top: 20px;
            gap: 20px;
        }

        /* LEFT PANEL */
        .left-panel {
            width: 250px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            height: fit-content;
            position: relative;
            z-index: 1;
        }

        .control-group {
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 15px;
        }

        .control-group h3 {
            margin-bottom: 10px;
            color: #333;
            font-size: 16px;
        }

        .btn {
            display: block;
            width: 100%;
            padding: 10px;
            border: none;
            cursor: pointer;
            margin-bottom: 8px;
            font-size: 14px;
            border-radius: 5px;
            transition: all 0.3s;
            text-align: left;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .btn-success { 
            background: #28a745; 
            color: white; 
        }
        .btn-danger { 
            background: #dc3545; 
            color: white; 
        }
        .btn-primary { 
            background: #000075; 
            color: white; 
        }
        .btn-info { 
            background: #000075; 
            color: white; 
        }

        /* MAIN CONTENT */
        .main-content {
            flex: 1;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .title-header {
            background: #000075;
            color: white;
            padding: 12px 25px;
            border-radius: 20px;
            font-size: 18px;
            font-weight: bold;
            margin: 0 auto 30px;
            text-align: center;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .circuit-container {
            display: flex;
            justify-content: space-between;
            gap: 30px;
            margin-top: 30px;
            flex-wrap: wrap;
        }





       
        /* LED MATRIX SECTION */
        .matrix-section {
            width: 300px;
        }
        .connect{
            width: 100%;
            height: 60px;
            background: #000000;
            border-radius: 20px;
        }
        .led-matrix-container {
            background: green;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.3);
        }

        .led-matrix {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(8, 1fr);
            gap: 3px;
            background: #34495e;
            padding: 10px;
            border-radius: 8px;
        }

        .led {
            width: 25px;
            height: 25px;
            background: white;
            border-radius: 50%;
            border: 2px solid #333;
            transition: all 0.3s ease;
            position: relative;
        }

        .led.on {
            background: #ff0000;
            border-color: #ff6666;
            box-shadow: 0 0 10px #ff0000, inset 0 0 5px rgba(255,255,255,0.3);
        }

        .led.green {
            background: #00ff00;
            border-color: #66ff66;
            box-shadow: 0 0 10px #00ff00, inset 0 0 5px rgba(255,255,255,0.3);
        }

        .led.blue {
            background: #0080ff;
            border-color: #66b3ff;
            box-shadow: 0 0 10px #0080ff, inset 0 0 5px rgba(255,255,255,0.3);
        }

        /* WIRING SECTION */
        .wiring-container {
            position: relative;
            width: 100%;
            height: 200px;
            margin: 20px 0;
        }

        .wire {
            position: absolute;
            border-radius: 2px;
            z-index: 5;
        }
        .wire-purple{
            background: purple;
            height: 3px;
            width: 740px;
            height: 3px;
            bottom: 665px;
            left: 253px;
        }
        .wire-purple1{
            background: purple;
            width: 3px;
            height: 135px;
            bottom: 533px;
            left: 253px;
        } 
        .wire-purple2{
            background:purple;
            width: 3px;
            height: 53px;
            bottom: 615px;
            right: 178px;
        }
        .wire-red {
            background: #ff0000;
            width: 450px;
            height: 3px;
            bottom: 300px;
            left: 263px;
        }

        .wire-green {
            background: #00ff00;
            height: 3px;
            width: 740px;
            height: 3px;
            bottom: 675px;
            left: 240px;
        }
        .wire-green1{
            background: #00ff00;
            width: 3px;
            height: 145px;
            bottom: 530px;
            left: 240px;
        } 
        .wire-green2{
            background:#00ff00;
            width: 3px;
            height: 63px;
            bottom: 615px;
            right: 190px;
        }
        .wire-blue {
            background: #0080ff;
            height: 3px;
             width: 450px;
            height: 3px;
            bottom: 290px;
            left: 273px;
        }
        .wire-blue1{
            background: blue;
            width: 3px;
            height: 25px;
            bottom: 290px;
            left: 273px;
        }
        .wire-black {
            background: #000000;
            height: 3px;

        }

        .wire-yellow {
             background: yellow;
            height: 3px;
            width: 780px;
            height: 3px;
            bottom: 659px;
            left: 227px;
        }
        .wire-yellow1{
            background: yellow;
            width: 3px;
            height: 130px;
            bottom: 532px;
            left: 227px;
        } 
        .wire-yellow2{
            background:yellow;
            width: 3px;
            height: 45px;
            bottom: 615px;
            right: 165px;
        }

        .wire-red1{
             background: #ff0000;
            width: 3px;
            height: 15px;
            bottom: 300px;
            left: 263px;
        }
        .wire-red2{
             background: #ff0000;
            width: 3px;
            height: 355px;
            bottom: 300px;
            right: 457px;
        }
        .wire-red3{
            background: #ff0000;
            width: 250px;
            height: 3px;
            bottom: 652px;
            right: 210px;
        }
        .wire-red4{
            background: #ff0000;
            width: 3px;
            height: 40px;
            bottom: 615px;
            right: 210px;
        }
         .wire-blue2{
             background:blue;
            width: 3px;
            height: 355px;
            bottom: 290px;
            right: 447px;
        }
        .wire-blue3{
            background: blue;
            width: 250px;
            height: 3px;
            bottom: 642px;
            right: 200px;
        }
        .wire-blue4{
            background: blue;
            width: 3px;
            height: 30px;
            bottom: 615px;
            right: 200px;
        }

        /* STATUS DISPLAY */
        .status-display {
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .status-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 8px 0;
            font-size: 13px;
        }

        .status-led {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #dc3545;
            transition: all 0.3s ease;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
        }

        .status-led.on {
            background: #28a745;
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.8);
        }

        /* CONTROL PANEL */
        .control-panel {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 30px;
        }

        .control-button {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 13px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            min-width: 120px;
        }

        .btn-power {
            background: linear-gradient(45deg, #4169e1, #8a2be2);
            color: white;
        }

        .btn-test {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
        }

        .btn-reset {
            background: #000075;
            color: white;
        }

        .control-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .control-button:active {
            transform: translateY(-1px);
        }

        /* MODAL STYLES */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(3px);
        }

        .modal-content {
            background: #000075;
            color: white;
            margin: 5% auto;
            padding: 20px;
            width: 50%;
            max-width: 700px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
            animation: slideDown 0.4s ease;
            position: relative;
        }

        .close {
            position: absolute;
            right: 20px;
            top: 15px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            color: white;
            transition: color 0.3s;
        }

        .close:hover {
            color: #ffcc00;
        }

        .modal-content h2 {
            font-size: 1.5em;
            margin-bottom: 15px;
            border-bottom: 2px solid rgba(255,255,255,0.2);
            padding-bottom: 8px;
        }

        pre {
            background: rgba(0,0,0,0.4);
            padding: 12px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        @keyframes slideDown {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* RESPONSIVE DESIGN */
        @media (max-width: 1024px) {
            .circuit-container {
                flex-direction: column;
                align-items: center;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .left-panel {
                width: 100%;
            }
            
            .arduino-section, .matrix-section {
                width: 100%;
                max-width: 350px;
                
            }
            
        }
    
    </style>
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <div class="logo">
                     <img src="/static/image/logo.png" width="80px" height="80px" alt="">
            <span>Arduino va 8x8 LED Matrix Simulyatsiyasi</span>
        </div>
    </header>

    <!-- MAIN CONTAINER -->
    <div class="main-container">
        <!-- LEFT PANEL -->
        <div class="left-panel">
            <div class="control-group">
                <h3>Boshqaruv</h3>
                <button class="btn btn-success" onclick="startSimulation()" id="startBtn">
                    Start
                </button>
                <button class="btn btn-danger" onclick="stopSimulation()" id="stopBtn">
                    Stop
                </button>
                <button class="btn btn-primary" onclick="togglePower()">
                    Quvvat
                </button>
                <button class="btn btn-info" onclick="runTest()">
                    Test
                </button>
            </div>

            <div class="control-group">
                <h3>Animatsiyalar</h3>
                <button class="btn btn-primary" onclick="showNumbers()">
                    Raqamlar
                </button>
                <button class="btn btn-primary" onclick="showLetters()">
                    Harflar
                </button>
                <button class="btn btn-primary" onclick="showPatterns()">
                    Naqshlar
                </button>
                <button class="btn btn-info" onclick="showHeart()">
                    Yurak
                </button>
            </div>

            <div class="control-group">
                <h3>Ma'lumotlar</h3>
                <button class="btn btn-primary" id="schemaBtn">
                    Sxema
                </button>
                <button class="btn btn-primary" id="codeBtn">
                    Kod
                </button>
                <button class="btn btn-primary" id="componentsBtn">
                    Qurilmalar
                </button>
            </div>

            <div class="control-group">
                <h3>Qurilma holati</h3>
                <div class="status-row">
                    <span>Quvvat:</span>
                    <div class="status-led" id="powerLed"></div>
                </div>
                <div class="status-row">
                    <span>Arduino:</span>
                    <div class="status-led" id="arduinoLed"></div>
                </div>
                <div class="status-row">
                    <span>LED Matrix:</span>
                    <div class="status-led" id="matrixLed"></div>
                </div>
                <div class="status-row">
                    <span>Animatsiya:</span>
                    <div class="status-led" id="animationLed"></div>
                </div>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            <div class="title-header">Arduino va 8x8 LED Matrix Boshqaruvi</div>
            
            <div class="circuit-container">
                <!-- ARDUINO SECTION -->
                <div class="arduino-section">
                    <div class="arduino-board" id="arduino">
                        <img src="/static/image/arduino1 - Copy.png" width="450px" height="400px" alt="">
                   
                    </div>

                 
                </div>

                <!-- LED MATRIX SECTION -->
                <div class="matrix-section">

                    <div class="led-matrix-container">
                        <h4 style="text-align: center; color: white; margin-bottom: 15px;">8x8 LED Matrix</h4>
                        <div class="connect"></div>
                        <div class="led-matrix" id="ledMatrix">
                            <!-- 64 LED elements will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- WIRING DIAGRAM -->
            <div class="wiring-container">
                <h4>Ulanish Sxemasi</h4>
                <!-- Wires will be positioned here -->
                <div class="wire wire-red "></div>
                <div class="wire wire-green "></div>
                <div class="wire wire-blue"></div>
                <div class="wire wire-black"></div>
                <div class="wire wire-yellow"></div>
                <div class="wire wire-red1"></div>
                <div class="wire wire-green1 "></div>
                <div class="wire wire-red2"></div>
                <div class="wire wire-green2"></div>
                <div class="wire wire-red3"></div>
                <div class="wire wire-red4"></div>
                <div class="wire wire-blue1"></div>
                <div class="wire wire-blue2"></div>
                <div class="wire wire-blue3"></div>
                <div class="wire wire-blue4"></div>
                <div class="wire wire-yellow1"></div>
                <div class="wire wire-yellow2"></div>
                <div class="wire wire-purple" ></div>
                <div class="wire wire-purple1" ></div>
                <div class="wire wire-purple2" ></div>
            </div>

            <!-- CONTROL PANEL -->
            <div class="control-panel">
                <button class="control-button btn-power" onclick="togglePower()">
                    Quvvat Yoqish/O'chirish
                </button>
                <button class="control-button btn-test" onclick="runFullTest()">
                    Tizimni Sinash
                </button>
                <button class="control-button btn-reset" onclick="resetAll()">
                    Qayta O'rnatish
                </button>
            </div>
        </div>
    </div>

    <!-- MODALS -->
    <div class="modal" id="schemaModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Arduino va 8x8 LED Matrix Sxemasi</h2>
            <p>Bu sxema Arduino UNO va MAX7219 asosida ishlaydi:</p>
            <pre>
Arduino UNO -> MAX7219 LED Matrix Driver
VCC      -> 5V
GND      -> GND
DIN      -> Digital Pin 2
CS       -> Digital Pin 3  
CLK      -> Digital Pin 4
            </pre>
            <p>MAX7219 LED drayveri 8x8 LED matrixni boshqarish uchun ishlatiladi.</p>
        </div>
    </div>

    <div class="modal" id="codeModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Arduino Kodi</h2>
            <pre>
#include <LedControl.h>

// MAX7219 ulanish pinlari
int DIN = 2;
int CS = 3;
int CLK = 4;

LedControl lc = LedControl(DIN, CLK, CS, 1);

void setup() {
  lc.shutdown(0, false);    // MAX7219 yoqish
  lc.setIntensity(0, 8);    // Yorqinlik (0-15)
  lc.clearDisplay(0);       // Ekranni tozalash
}

void loop() {
  // Raqamlarni ko'rsatish
  showNumbers();
  delay(1000);
  
  // Harflarni ko'rsatish  
  showLetters();
  delay(1000);
  
  // Yurak naqshini ko'rsatish
  showHeart();
  delay(2000);
}

void showNumbers() {
  // 0-9 raqamlarini ketma-ket ko'rsatish
  for(int i = 0; i <= 9; i++) {
    lc.setDigit(0, 0, i, false);
    delay(500);
  }
}

void showLetters() {
  // A harfini ko'rsatish
  byte letterA[8] = {
    0x18, 0x3C, 0x66, 0x66,
    0x7E, 0x66, 0x66, 0x00
  };
  
  for(int i = 0; i < 8; i++) {
    lc.setRow(0, i, letterA[i]);
  }
}

void showHeart() {
  byte heart[8] = {
    0x00, 0x66, 0xFF, 0xFF,
    0xFF, 0x7E, 0x3C, 0x18
  };
  
  for(int i = 0; i < 8; i++) {
    lc.setRow(0, i, heart[i]);
  }
}
            </pre>
        </div>
    </div>

    <div class="modal" id="componentsModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Ishlatilgan Qurilmalar</h2>
            <h3>1. Arduino UNO</h3>
            <p>Microcontroller board - asosiy boshqaruv bloki</p>
            
            <h3>2. MAX7219 LED Matrix Driver</h3>
            <p>8x8 LED matrixni boshqarish uchun maxsus mikroschema</p>
            
            <h3>3. 8x8 LED Matrix</h3>
            <p>64 ta LEDdan tashkil topgan displey</p>
            
            <h3>4. Ulanish simlari</h3>
            <p>Arduino va LED matrix o'rtasidagi ulanishlar</p>
            
            <h3>Texnik ma'lumotlar:</h3>
            <pre>
Kuchlanish: 5V DC
Tok iste'moli: 200-300mA
Yorqinlik: 15 darajagacha sozlanadi  
Interfeys: SPI (Serial Peripheral Interface)
Boshqaruv pinlari: 3 ta (DIN, CS, CLK)
            </pre>
        </div>
    </div>

    <script>
        // System State Variables
        let powerOn = false;
        let animationRunning = false;
        let currentAnimation = null;

        // DOM Elements
        const elements = {
            powerLed: document.getElementById('powerLed'),
            arduinoLed: document.getElementById('arduinoLed'),
            matrixLed: document.getElementById('matrixLed'),
            animationLed: document.getElementById('animationLed'),
            pin2Led: document.getElementById('pin2Led'),
            pin3Led: document.getElementById('pin3Led'),
            pin4Led: document.getElementById('pin4Led'),
            pin5Led: document.getElementById('pin5Led'),
            arduino: document.getElementById('arduino'),
            ledMatrix: document.getElementById('ledMatrix')
        };

        // Initialize LED Matrix
        function initializeLEDMatrix() {
            const matrix = elements.ledMatrix;
            matrix.innerHTML = '';
            
            for (let i = 0; i < 64; i++) {
                const led = document.createElement('div');
                led.className = 'led';
                led.id = `led-${i}`;
                matrix.appendChild(led);
            }
        }

        // Update Status LEDs
        function updateStatus() {
            elements.powerLed.classList.toggle('on', powerOn);
            elements.arduinoLed.classList.toggle('on', powerOn);
            elements.matrixLed.classList.toggle('on', powerOn && animationRunning);
            elements.animationLed.classList.toggle('on', animationRunning);
            
            // Arduino pin status
            elements.pin2Led.classList.toggle('on', powerOn);
            elements.pin3Led.classList.toggle('on', powerOn);
            elements.pin4Led.classList.toggle('on', powerOn);
            elements.pin5Led.classList.toggle('on', powerOn);
        }

        // Power Control
        function togglePower() {
            powerOn = !powerOn;
            
            if (!powerOn) {
                stopSimulation();
                clearMatrix();
            } else {
                elements.arduino.style.boxShadow = '0 0 20px #0066ff';
            }
            
            updateStatus();
        }

        // Clear LED Matrix
        function clearMatrix() {
            for (let i = 0; i < 64; i++) {
                const led = document.getElementById(`led-${i}`);
                led.className = 'led';
            }
        }

        // Set LED at position
        function setLED(row, col, className = 'on') {
            const index = row * 8 + col;
            const led = document.getElementById(`led-${index}`);
            led.className = `led ${className}`;
        }

        // Pattern definitions
        const patterns = {
            numbers: [
                // 0
                [[0,1,1,1,1,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,1,1,1,1,0,0],
                 [0,0,0,0,0,0,0,0]],
                // 1
                [[0,0,0,1,0,0,0,0],
                 [0,0,1,1,0,0,0,0],
                 [0,0,0,1,0,0,0,0],
                 [0,0,0,1,0,0,0,0],
                 [0,0,0,1,0,0,0,0],
                 [0,0,0,1,0,0,0,0],
                 [0,0,1,1,1,0,0,0],
                 [0,0,0,0,0,0,0,0]],
                // 2
                [[0,1,1,1,1,1,0,0],
                 [0,0,0,0,0,1,0,0],
                 [0,0,0,0,0,1,0,0],
                 [0,1,1,1,1,1,0,0],
                 [0,1,0,0,0,0,0,0],
                 [0,1,0,0,0,0,0,0],
                 [0,1,1,1,1,1,0,0],
                 [0,0,0,0,0,0,0,0]]
            ],
            letters: [
                // A
                [[0,0,1,1,1,0,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,1,1,1,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,0,0,0,0,0,0,0]],
                // B
                [[0,1,1,1,1,0,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,1,1,1,0,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,0,0,0,1,0,0],
                 [0,1,1,1,1,0,0,0],
                 [0,0,0,0,0,0,0,0]],
                // C
                [[0,1,1,1,1,1,0,0],
                 [0,1,0,0,0,0,0,0],
                 [0,1,0,0,0,0,0,0],
                 [0,1,0,0,0,0,0,0],
                 [0,1,0,0,0,0,0,0],
                 [0,1,0,0,0,0,0,0],
                 [0,1,1,1,1,1,0,0],
                 [0,0,0,0,0,0,0,0]]
            ],
            heart: [
                [0,0,0,0,0,0,0,0],
                [0,1,1,0,0,1,1,0],
                [1,1,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1],
                [0,1,1,1,1,1,1,0],
                [0,0,1,1,1,1,0,0],
                [0,0,0,1,1,0,0,0],
                [0,0,0,0,0,0,0,0]
            ],
            patterns: [
                // Diagonal pattern
                [[1,0,0,0,0,0,0,0],
                 [0,1,0,0,0,0,0,0],
                 [0,0,1,0,0,0,0,0],
                 [0,0,0,1,0,0,0,0],
                 [0,0,0,0,1,0,0,0],
                 [0,0,0,0,0,1,0,0],
                 [0,0,0,0,0,0,1,0],
                 [0,0,0,0,0,0,0,1]],
                // Cross pattern
                [[0,0,0,1,1,0,0,0],
                 [0,0,0,1,1,0,0,0],
                 [0,0,0,1,1,0,0,0],
                 [1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1],
                 [0,0,0,1,1,0,0,0],
                 [0,0,0,1,1,0,0,0],
                 [0,0,0,1,1,0,0,0]]
            ]
        };

        // Show pattern on matrix
        function showPattern(pattern, color = 'on') {
            clearMatrix();
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    if (pattern[row][col] === 1) {
                        setLED(row, col, color);
                    }
                }
            }
        }

        // Animation functions
        function showNumbers() {
            if (!powerOn) return;
            
            animationRunning = true;
            updateStatus();
            
            let index = 0;
            currentAnimation = setInterval(() => {
                if (index < patterns.numbers.length) {
                    showPattern(patterns.numbers[index], 'on');
                    index++;
                } else {
                    clearInterval(currentAnimation);
                    animationRunning = false;
                    updateStatus();
                }
            }, 1000);
        }

        function showLetters() {
            if (!powerOn) return;
            
            animationRunning = true;
            updateStatus();
            
            let index = 0;
            currentAnimation = setInterval(() => {
                if (index < patterns.letters.length) {
                    showPattern(patterns.letters[index], 'blue');
                    index++;
                } else {
                    clearInterval(currentAnimation);
                    animationRunning = false;
                    updateStatus();
                }
            }, 1500);
        }

        function showPatterns() {
            if (!powerOn) return;
            
            animationRunning = true;
            updateStatus();
            
            let index = 0;
            currentAnimation = setInterval(() => {
                if (index < patterns.patterns.length) {
                    showPattern(patterns.patterns[index], 'green');
                    index++;
                } else {
                    clearInterval(currentAnimation);
                    animationRunning = false;
                    updateStatus();
                }
            }, 2000);
        }

        function showHeart() {
            if (!powerOn) return;
            
            animationRunning = true;
            updateStatus();
            
            // Animate heart beating
            let beats = 0;
            currentAnimation = setInterval(() => {
                if (beats < 6) {
                    if (beats % 2 === 0) {
                        showPattern(patterns.heart, 'on');
                    } else {
                        clearMatrix();
                    }
                    beats++;
                } else {
                    showPattern(patterns.heart, 'on');
                    clearInterval(currentAnimation);
                    animationRunning = false;
                    updateStatus();
                }
            }, 500);
        }

        // System control functions
        function startSimulation() {
            if (!powerOn) {
                alert('Avval quvvatni yoqing!');
                return;
            }
            
            // Run automatic sequence
            setTimeout(() => showNumbers(), 500);
            setTimeout(() => showLetters(), 4000);
            setTimeout(() => showPatterns(), 8500);
            setTimeout(() => showHeart(), 12500);
        }

        function stopSimulation() {
            if (currentAnimation) {
                clearInterval(currentAnimation);
                currentAnimation = null;
            }
            animationRunning = false;
            clearMatrix();
            updateStatus();
        }

        function runTest() {
            if (!powerOn) {
                alert('Avval quvvatni yoqing!');
                return;
            }
            
            // Test all LEDs
            animationRunning = true;
            updateStatus();
            
            let ledIndex = 0;
            currentAnimation = setInterval(() => {
                if (ledIndex < 64) {
                    clearMatrix();
                    const led = document.getElementById(`led-${ledIndex}`);
                    led.className = 'led on';
                    ledIndex++;
                } else {
                    clearMatrix();
                    clearInterval(currentAnimation);
                    animationRunning = false;
                    updateStatus();
                }
            }, 50);
        }

        function runFullTest() {
            if (!powerOn) {
                alert('Avval quvvatni yoqing!');
                return;
            }
            
            // Full system test
            runTest();
            setTimeout(() => {
                showNumbers();
                setTimeout(() => {
                    showLetters();
                    setTimeout(() => {
                        showHeart();
                    }, 5000);
                }, 4000);
            }, 3500);
        }

        function resetAll() {
            stopSimulation();
            clearMatrix();
            powerOn = false;
            elements.arduino.style.boxShadow = '';
            updateStatus();
        }

        // Modal functions
        function openModal(id) {
            document.getElementById(id).style.display = "block";
        }

        function closeModal(id) {
            document.getElementById(id).style.display = "none";
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            initializeLEDMatrix();
            updateStatus();
            
            // Modal event listeners
            document.getElementById("schemaBtn").addEventListener("click", function() {
                openModal("schemaModal");
            });
            
            document.getElementById("codeBtn").addEventListener("click", function() {
                openModal("codeModal");
            });
            
            document.getElementById("componentsBtn").addEventListener("click", function() {
                openModal("componentsModal");
            });

            // Close modal buttons
            document.querySelectorAll(".modal .close").forEach(btn => {
                btn.addEventListener("click", function() {
                    this.closest(".modal").style.display = "none";
                });
            });

            // Close modal when clicking outside
            window.addEventListener("click", function(e) {
                document.querySelectorAll(".modal").forEach(modal => {
                    if (e.target === modal) {
                        modal.style.display = "none";
                    }
                });
            });
        });
    </script>
</body>
</html>