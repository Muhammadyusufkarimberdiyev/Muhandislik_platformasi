<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sinf darslari - Milliy Muhandislik Platformasi</title>
  <link rel="stylesheet" href="/static/style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .no-video-placeholder {
      width: 100%;
      height: 250px;
      background: linear-gradient(135deg, #000075 0%, #0056b3 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 60px;
      border-radius: 15px;
    }

    .video-info-overlay {
      padding: 1.5rem;
      background: white;
    }

    video, iframe {
      box-shadow: 0 10px 30px rgba(0,0,117,0.2);
    }
  </style>
</head>

<body>
  <header>
    <nav>
      <a href="/"><img src="/static/image/logo.png" alt="Logo" /></a>

      <form method="get" class="search-box">
        <i class="fa fa-search"></i>
        <input type="text" name="q" value="{{ cquery|default:'' }}" placeholder="Qidiruv..." />
      </form>

      <div class="menu-toggle" id="menuToggle">
        <span></span>
        <span></span>
        <span></span>
      </div>

      <ul id="navMenu">
        <a href="/"><li>Asosiy sahifa</li></a>
      </ul>
    </nav>
  </header>

  <section style="padding: 2rem;">
    <style>
      .header-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 2rem;
      }
      .back-btn {
        padding: 10px 20px;
        background: #000075;
        color: white;
        border-radius: 10px;
        text-decoration: none;
        font-weight: 600;
      }
      .back-btn:hover {
        opacity: 0.9;
      }
      section {
        max-width: 1200px;
        margin: 0 auto;
        padding: 3rem 2rem;
      }
    </style>

    <div class="header-row">
      <h1>Sinf darslari</h1>
      <a class="back-btn" href="{% url 'main:class' %}">← Kategoriyalar</a>
    </div>

    <div class="video-grid">
      {% for v in videos %}
        <div class="video-card">
          <div class="video-thumbnail">
            {% if v.video_file %}
              <!-- Yuklangan video fayl - HTML5 default controls -->
              <video 
                controls 
                preload="metadata"
                controlsList="nodownload"
                style="width: 100%; height: 200px;  background: #000; ">
                <source src="{{ v.video_file.url }}" type="video/mp4">
                Brauzeringiz video tegini qo'llab-quvvatlamaydi.
              </video>
            {% elif v.link %}
              <!-- YouTube/embed link -->
              <iframe 
                src="{{ v.link }}" 
                title="{{ v.name }}" 
                frameborder="0"
                style="width: 100%; height: 250px; border-radius: 15px;"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                referrerpolicy="strict-origin-when-cross-origin" 
                allowfullscreen>
              </iframe>
            {% else %}
              <div class="no-video-placeholder">
                <i class="fas fa-graduation-cap"></i>
              </div>
            {% endif %}
          </div>

          <div class="video-info-overlay">
            <div class="video-title">{{ v.name }}</div>
            <div class="video-meta">
              <span class="chip">{{ v.category.name }}</span>
              <span class="chip">{{ v.date|date:"Y-m-d" }}</span>
            </div>
          </div>
        </div>
      {% empty %}
        <p class="no-results">Hech qanday video topilmadi.</p>
      {% endfor %}
    </div>

    {% if page and page.has_other_pages %}
      <div class="pagination">
        {% if page.has_previous %}
          <a class="page-prev"
             href="?{% if active_ccat %}category={{ active_ccat }}&{% endif %}{% if cquery %}q={{ cquery }}&{% endif %}page={{ page.previous_page_number }}">⬅</a>
        {% endif %}

        {% for num in paginator.page_range %}
          <a class="page-dot{% if page.number == num %} active{% endif %}"
             href="?{% if active_ccat %}category={{ active_ccat }}&{% endif %}{% if cquery %}q={{ cquery }}&{% endif %}page={{ num }}">
          </a>
        {% endfor %}

        {% if page.has_next %}
          <a class="page-next"
             href="?{% if active_ccat %}category={{ active_ccat }}&{% endif %}{% if cquery %}q={{ cquery }}&{% endif %}page={{ page.next_page_number }}">➡</a>
        {% endif %}
      </div>
    {% endif %}
  </section>
 <footer>
      <div class="footer">
        <div class="left">
          <img src="/static/image/muallif.jpg" alt="Muallif logotipi">
          <p>
<span style="display: block; text-align: center; font-size: 20px; font-weight: bold;">
    Muallif : Muhammad Al-Xorazmiy Nomidagi Ixtisoslashtirilgan Maktab Andijon Filiali
</span>

              <br>Ushbu platforma O'zbekiston Respublikasi Prezidentining <br> 2024-yil 1-apreldagi PF-55-son
            Farmoniga asosan tashkil etilgan 2025-yilgi Ixtirochilikka qadam tanlovini 1-o'rin <br> sohibi hamda
            amaliyotgan tadbiq etish uchun Oliy ta'lim <br> va innovatsiyalar vazirligi huzuridagi
            Ilm-fanni moliyalashtirish va innovatsiyalarni qo'llab-quvvatlash jamg'armasi tomonidan
            56 mln so'm miqdorida moliyalashtirilgan.
          </p>
        </div>
        <div class="center">
          <h2>Aloqa uchun</h2>
          <p>Manzil: Andijon shahar, Qalandarxona mahalla fuqarolar yig'ini,<br> Buxoro ko'chasi, 4 uy</p>
          <p>Tel: +998 94 212 14 48</p>
          <p>Gmail: ixm337@piima.uz</p>
          <ul class="social-icons">
            <li><a href="https://www.facebook.com/share/1C2cE7VJQR/?mibextid=wwXIfr" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
            <li><a href="https://www.youtube.com/@Milliy_muhandislik_platformasi" target="_blank"><i class="fab fa-youtube"></i></a></li>
            <li><a href="https://www.instagram.com/itschool_andijan?igsh=MWdkMzQ4Zmt5MzhxaA==" target="_blank"><i class="fab fa-instagram"></i></a></li>
            <li><a href="https://t.me/milliy_muhandislik" target="_blank"><i class="fab fa-telegram"></i></a></li>
          </ul>
        </div>
      </div>
      <div class="bottom">
        <p>Yaratilgan 2025 MMP | Dizayn va Dasturlash muallifi</p>
      </div>
    </footer>


  <script src="/static/index.js"></script>
  <script>
    const menuToggle = document.getElementById('menuToggle');
    const navMenu = document.getElementById('navMenu');

    menuToggle.addEventListener('click', function() {
      navMenu.classList.toggle('active');
      this.classList.toggle('active');
    });

    document.addEventListener('click', function(e) {
      if (!menuToggle.contains(e.target) && !navMenu.contains(e.target)) {
        navMenu.classList.remove('active');
        menuToggle.classList.remove('active');
      }
    });
  </script>
</body>
</html>